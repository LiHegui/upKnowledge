import{_ as s,e as a,f as p,o as e}from"./app-BeRZjn83.js";const t="/upKnowledge/assets/bug1-Lk1Ywyhu.png",l={};function i(c,n){return e(),a("div",null,n[0]||(n[0]=[p(`<h1 id="有关api" tabindex="-1"><a class="header-anchor" href="#有关api"><span>有关API</span></a></h1><ul><li>wx.getSetting(Object object) <blockquote><p>获取用户的当前设置。返回值中只会出现小程序已经向用户请求过的权限</p></blockquote></li><li>wx.authorize(Object object) <blockquote><p>提前向用户发起授权请求。调用后会立刻弹窗询问用户是否同意授权小程序使用某项功能或获取用户的某些数据，但不会实际调用对应接口。如果用户之前已经同意授权，则不会出现弹窗，直接返回成功</p></blockquote></li></ul><h1 id="方案" tabindex="-1"><a class="header-anchor" href="#方案"><span>方案</span></a></h1><p>例子：获取权限方案，上传图片</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line">    wx<span class="token punctuation">.</span><span class="token function">getSetting</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">success</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>res<span class="token punctuation">.</span>authSetting<span class="token punctuation">[</span><span class="token string">&#39;scope.writePhotosAlbum&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            wx<span class="token punctuation">.</span><span class="token function">authorize</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">              <span class="token literal-property property">scope</span><span class="token operator">:</span> <span class="token string">&#39;scope.writePhotosAlbum&#39;</span><span class="token punctuation">,</span></span>
<span class="line">              <span class="token function">success</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token comment">// 成功回调</span></span>
<span class="line">              <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">              <span class="token function">fail</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                wx<span class="token punctuation">.</span><span class="token function">showToast</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">                  <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&#39;检测手机未开启保存相册的权限，请开启后重试&#39;</span><span class="token punctuation">,</span></span>
<span class="line">                  <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token string">&#39;none&#39;</span><span class="token punctuation">,</span></span>
<span class="line">                  <span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">2000</span><span class="token punctuation">,</span></span>
<span class="line">                <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">              <span class="token punctuation">}</span></span>
<span class="line">            <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token comment">// 已经获取权限的处理</span></span>
<span class="line">          <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="遇到的坑" tabindex="-1"><a class="header-anchor" href="#遇到的坑"><span>遇到的坑</span></a></h2><p><img src="`+t+'" alt="Alt text"></p><p>直接用上述的方法，在开发版本和体验版本都是可以直接用的。但是真正发布之后会有一直执行fail回调，需要提交审核完善用户权限才可以❗ 是需要微信那边进行审核的。</p><h2 id="小程序用户隐私保护指引" tabindex="-1"><a class="header-anchor" href="#小程序用户隐私保护指引"><span>小程序用户隐私保护指引</span></a></h2><p>这个地方看官方文档的解释就好 <a href="https://developers.weixin.qq.com/miniprogram/dev/framework/user-privacy/" target="_blank" rel="noopener noreferrer">&#39;官方文档&#39;</a></p>',10)]))}const u=s(l,[["render",i],["__file","权限.html.vue"]]),r=JSON.parse('{"path":"/tools/repository/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%EF%BC%88%E5%8E%9F%E7%94%9F%EF%BC%89/%E6%9D%83%E9%99%90.html","title":"有关API","lang":"zh-CN","frontmatter":{},"headers":[{"level":2,"title":"遇到的坑","slug":"遇到的坑","link":"#遇到的坑","children":[]},{"level":2,"title":"小程序用户隐私保护指引","slug":"小程序用户隐私保护指引","link":"#小程序用户隐私保护指引","children":[]}],"git":{"updatedTime":1738722167000,"contributors":[{"name":"LiHegui","username":"LiHegui","email":"1487647822@qq.com","commits":1,"url":"https://github.com/LiHegui"}]},"filePathRelative":"tools/repository/微信小程序（原生）/权限.md"}');export{u as comp,r as data};
